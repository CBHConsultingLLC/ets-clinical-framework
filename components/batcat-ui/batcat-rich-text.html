<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Clinical Rich Text Editor</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <style>
        .batcat-rtf-container {
            background: white;
            border: 1px solid #d1d5db;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }
        
        .batcat-rtf-toolbar {
            background: #f8fafc;
            border-bottom: 1px solid #e2e8f0;
            padding: 0.75rem;
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            align-items: center;
        }
        
        .batcat-rtf-toolbar-group {
            display: flex;
            gap: 0.25rem;
            align-items: center;
            padding-right: 0.75rem;
            border-right: 1px solid #e2e8f0;
        }
        
        .batcat-rtf-toolbar-group:last-child {
            border-right: none;
        }
        
        .batcat-rtf-btn {
            background: none;
            border: 1px solid transparent;
            border-radius: 4px;
            padding: 0.375rem;
            color: #374151;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            width: 32px;
            height: 32px;
        }
        
        .batcat-rtf-btn:hover {
            background: #f3f4f6;
            border-color: #d1d5db;
        }
        
        .batcat-rtf-btn.active {
            background: #3b82f6;
            color: white;
            border-color: #3b82f6;
        }
        
        .batcat-rtf-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .batcat-rtf-select {
            background: white;
            border: 1px solid #d1d5db;
            border-radius: 4px;
            padding: 0.25rem 0.5rem;
            font-size: 0.875rem;
            color: #374151;
            cursor: pointer;
        }
        
        .batcat-rtf-editor {
            min-height: 200px;
            padding: 1rem;
            border: none;
            outline: none;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            font-size: 0.875rem;
            line-height: 1.5;
            color: #1f2937;
            background: white;
        }
        
        .batcat-rtf-editor:empty::before {
            content: "Start typing your clinical notes...";
            color: #9ca3af;
            font-style: italic;
        }
        
        .batcat-rtf-editor h1,
        .batcat-rtf-editor h2,
        .batcat-rtf-editor h3 {
            margin: 1rem 0 0.5rem 0;
            font-weight: 600;
            color: #1f2937;
        }
        
        .batcat-rtf-editor h1 { font-size: 1.5rem; }
        .batcat-rtf-editor h2 { font-size: 1.25rem; }
        .batcat-rtf-editor h3 { font-size: 1.125rem; }
        
        .batcat-rtf-editor p {
            margin: 0.5rem 0;
        }
        
        .batcat-rtf-editor ul,
        .batcat-rtf-editor ol {
            margin: 0.5rem 0;
            padding-left: 1.5rem;
        }
        
        .batcat-rtf-editor blockquote {
            margin: 1rem 0;
            padding: 0.75rem 1rem;
            background: #f8fafc;
            border-left: 4px solid #3b82f6;
            border-radius: 0 4px 4px 0;
        }
        
        .batcat-rtf-editor code {
            background: #f3f4f6;
            padding: 0.125rem 0.25rem;
            border-radius: 3px;
            font-family: 'Courier New', monospace;
            font-size: 0.8rem;
        }
        
        .batcat-rtf-editor pre {
            background: #f3f4f6;
            padding: 1rem;
            border-radius: 4px;
            overflow-x: auto;
            margin: 1rem 0;
        }
        
        .batcat-rtf-editor table {
            border-collapse: collapse;
            width: 100%;
            margin: 1rem 0;
        }
        
        .batcat-rtf-editor table th,
        .batcat-rtf-editor table td {
            border: 1px solid #d1d5db;
            padding: 0.5rem;
            text-align: left;
        }
        
        .batcat-rtf-editor table th {
            background: #f8fafc;
            font-weight: 600;
        }
        
        .batcat-rtf-footer {
            background: #f8fafc;
            border-top: 1px solid #e2e8f0;
            padding: 0.75rem 1rem;
            display: flex;
            justify-content: between;
            align-items: center;
        }
        
        .batcat-rtf-char-count {
            color: #6b7280;
            font-size: 0.75rem;
        }
        
        .batcat-rtf-actions {
            display: flex;
            gap: 0.5rem;
        }
        
        .batcat-rtf-template {
            background: white;
            border: 1px solid #d1d5db;
            border-radius: 6px;
            padding: 0.75rem;
            margin-bottom: 1rem;
        }
        
        .batcat-rtf-template h6 {
            margin: 0 0 0.5rem 0;
            color: #374151;
            font-weight: 600;
        }
        
        .batcat-rtf-template p {
            margin: 0;
            color: #6b7280;
            font-size: 0.875rem;
        }
        
        .batcat-rtf-template-btn {
            background: #f8fafc;
            border: 1px solid #d1d5db;
            border-radius: 4px;
            padding: 0.5rem 1rem;
            color: #374151;
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 0.875rem;
        }
        
        .batcat-rtf-template-btn:hover {
            background: #f3f4f6;
            border-color: #9ca3af;
        }
        
        .batcat-rtf-section {
            margin-bottom: 2rem;
        }
        
        .batcat-rtf-section h4 {
            color: #1f2937;
            margin-bottom: 1rem;
            font-size: 1.125rem;
            font-weight: 600;
        }
        
        .batcat-rtf-modal {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.5);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 1000;
        }
        
        .batcat-rtf-modal-content {
            background: white;
            border-radius: 8px;
            padding: 1.5rem;
            max-width: 500px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
        }
        
        .batcat-rtf-modal-header {
            display: flex;
            justify-content: between;
            align-items: center;
            margin-bottom: 1rem;
        }
        
        .batcat-rtf-modal-title {
            font-size: 1.125rem;
            font-weight: 600;
            color: #1f2937;
            margin: 0;
        }
        
        .batcat-rtf-modal-close {
            background: none;
            border: none;
            font-size: 1.5rem;
            color: #6b7280;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <div class="container mt-4">
        <h2>Clinical Rich Text Editor</h2>
        <p class="lead">A comprehensive rich text editor component designed for clinical documentation with modern healthcare UI patterns.</p>
        
        <!-- Basic Rich Text Editor -->
        <div class="batcat-rtf-section">
            <h4>Basic Rich Text Editor</h4>
            
            <div class="batcat-rtf-container">
                <div class="batcat-rtf-toolbar">
                    <!-- Text Formatting -->
                    <div class="batcat-rtf-toolbar-group">
                        <button class="batcat-rtf-btn" data-command="bold" title="Bold">
                            <i class="fas fa-bold"></i>
                        </button>
                        <button class="batcat-rtf-btn" data-command="italic" title="Italic">
                            <i class="fas fa-italic"></i>
                        </button>
                        <button class="batcat-rtf-btn" data-command="underline" title="Underline">
                            <i class="fas fa-underline"></i>
                        </button>
                        <button class="batcat-rtf-btn" data-command="strikeThrough" title="Strikethrough">
                            <i class="fas fa-strikethrough"></i>
                        </button>
                    </div>
                    
                    <!-- Headings -->
                    <div class="batcat-rtf-toolbar-group">
                        <select class="batcat-rtf-select" id="headingSelect">
                            <option value="">Normal</option>
                            <option value="h1">Heading 1</option>
                            <option value="h2">Heading 2</option>
                            <option value="h3">Heading 3</option>
                        </select>
                    </div>
                    
                    <!-- Lists -->
                    <div class="batcat-rtf-toolbar-group">
                        <button class="batcat-rtf-btn" data-command="insertUnorderedList" title="Bullet List">
                            <i class="fas fa-list-ul"></i>
                        </button>
                        <button class="batcat-rtf-btn" data-command="insertOrderedList" title="Numbered List">
                            <i class="fas fa-list-ol"></i>
                        </button>
                    </div>
                    
                    <!-- Alignment -->
                    <div class="batcat-rtf-toolbar-group">
                        <button class="batcat-rtf-btn" data-command="justifyLeft" title="Align Left">
                            <i class="fas fa-align-left"></i>
                        </button>
                        <button class="batcat-rtf-btn" data-command="justifyCenter" title="Align Center">
                            <i class="fas fa-align-center"></i>
                        </button>
                        <button class="batcat-rtf-btn" data-command="justifyRight" title="Align Right">
                            <i class="fas fa-align-right"></i>
                        </button>
                    </div>
                    
                    <!-- Insert -->
                    <div class="batcat-rtf-toolbar-group">
                        <button class="batcat-rtf-btn" data-command="insertHorizontalRule" title="Horizontal Rule">
                            <i class="fas fa-minus"></i>
                        </button>
                        <button class="batcat-rtf-btn" id="insertTable" title="Insert Table">
                            <i class="fas fa-table"></i>
                        </button>
                        <button class="batcat-rtf-btn" id="insertLink" title="Insert Link">
                            <i class="fas fa-link"></i>
                        </button>
                    </div>
                    
                    <!-- Undo/Redo -->
                    <div class="batcat-rtf-toolbar-group">
                        <button class="batcat-rtf-btn" data-command="undo" title="Undo">
                            <i class="fas fa-undo"></i>
                        </button>
                        <button class="batcat-rtf-btn" data-command="redo" title="Redo">
                            <i class="fas fa-redo"></i>
                        </button>
                    </div>
                </div>
                
                <div class="batcat-rtf-editor" contenteditable="true" id="rtfEditor">
                    <h2>Patient Assessment</h2>
                    <p><strong>Chief Complaint:</strong> Patient presents with chest pain and shortness of breath.</p>
                    <p><strong>History of Present Illness:</strong> 45-year-old male with a 2-hour history of acute onset chest pain described as pressure-like, radiating to the left arm. Associated with diaphoresis and nausea.</p>
                    <h3>Vital Signs</h3>
                    <ul>
                        <li>Blood Pressure: 140/90 mmHg</li>
                        <li>Heart Rate: 95 bpm</li>
                        <li>Temperature: 98.6Â°F</li>
                        <li>Respiratory Rate: 22/min</li>
                    </ul>
                    <h3>Assessment and Plan</h3>
                    <ol>
                        <li>Obtain 12-lead ECG</li>
                        <li>Cardiac enzymes (troponin, CK-MB)</li>
                        <li>Chest X-ray</li>
                        <li>Consider cardiology consultation</li>
                    </ol>
                </div>
                
                <div class="batcat-rtf-footer">
                    <div class="batcat-rtf-char-count">
                        <span id="charCount">0</span> characters
                    </div>
                    <div class="batcat-rtf-actions">
                        <button class="btn btn-outline-secondary btn-sm">Clear</button>
                        <button class="btn btn-primary btn-sm">Save</button>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Clinical Templates -->
        <div class="batcat-rtf-section">
            <h4>Clinical Templates</h4>
            
            <div class="row">
                <div class="col-md-4">
                    <div class="batcat-rtf-template">
                        <h6>Progress Note</h6>
                        <p>Standard progress note template with assessment and plan sections.</p>
                        <button class="batcat-rtf-template-btn" data-template="progress">Use Template</button>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="batcat-rtf-template">
                        <h6>Discharge Summary</h6>
                        <p>Comprehensive discharge summary template for patient handoff.</p>
                        <button class="batcat-rtf-template-btn" data-template="discharge">Use Template</button>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="batcat-rtf-template">
                        <h6>Consultation Note</h6>
                        <p>Specialist consultation template with referral information.</p>
                        <button class="batcat-rtf-template-btn" data-template="consultation">Use Template</button>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Table Insert Modal -->
        <div class="batcat-rtf-modal" id="tableModal">
            <div class="batcat-rtf-modal-content">
                <div class="batcat-rtf-modal-header">
                    <h5 class="batcat-rtf-modal-title">Insert Table</h5>
                    <button class="batcat-rtf-modal-close" id="closeTableModal">&times;</button>
                </div>
                <div class="mb-3">
                    <label class="form-label">Rows:</label>
                    <input type="number" class="form-control" id="tableRows" value="3" min="1" max="20">
                </div>
                <div class="mb-3">
                    <label class="form-label">Columns:</label>
                    <input type="number" class="form-control" id="tableCols" value="3" min="1" max="10">
                </div>
                <div class="d-flex gap-2">
                    <button class="btn btn-primary" id="insertTableBtn">Insert Table</button>
                    <button class="btn btn-secondary" id="cancelTableBtn">Cancel</button>
                </div>
            </div>
        </div>
        
        <!-- Link Insert Modal -->
        <div class="batcat-rtf-modal" id="linkModal">
            <div class="batcat-rtf-modal-content">
                <div class="batcat-rtf-modal-header">
                    <h5 class="batcat-rtf-modal-title">Insert Link</h5>
                    <button class="batcat-rtf-modal-close" id="closeLinkModal">&times;</button>
                </div>
                <div class="mb-3">
                    <label class="form-label">Link Text:</label>
                    <input type="text" class="form-control" id="linkText" placeholder="Link text">
                </div>
                <div class="mb-3">
                    <label class="form-label">URL:</label>
                    <input type="url" class="form-control" id="linkUrl" placeholder="https://example.com">
                </div>
                <div class="d-flex gap-2">
                    <button class="btn btn-primary" id="insertLinkBtn">Insert Link</button>
                    <button class="btn btn-secondary" id="cancelLinkBtn">Cancel</button>
                </div>
            </div>
        </div>
        
        <!-- Usage Documentation -->
        <div class="row mt-4">
            <div class="col-12">
                <h3>Features</h3>
                <ul>
                    <li><strong>Text Formatting:</strong> Bold, italic, underline, strikethrough</li>
                    <li><strong>Headings:</strong> H1, H2, H3 support</li>
                    <li><strong>Lists:</strong> Bulleted and numbered lists</li>
                    <li><strong>Alignment:</strong> Left, center, right alignment</li>
                    <li><strong>Tables:</strong> Insert and format tables</li>
                    <li><strong>Links:</strong> Insert and edit hyperlinks</li>
                    <li><strong>Templates:</strong> Pre-built clinical note templates</li>
                    <li><strong>Undo/Redo:</strong> Full undo/redo support</li>
                    <li><strong>Character Count:</strong> Real-time character counting</li>
                </ul>
                
                <h3>Usage</h3>
                <pre><code>&lt;div class="batcat-rtf-container"&gt;
    &lt;div class="batcat-rtf-toolbar"&gt;
        &lt;!-- Toolbar buttons --&gt;
    &lt;/div&gt;
    &lt;div class="batcat-rtf-editor" contenteditable="true"&gt;
        &lt;!-- Editor content --&gt;
    &lt;/div&gt;
    &lt;div class="batcat-rtf-footer"&gt;
        &lt;!-- Footer actions --&gt;
    &lt;/div&gt;
&lt;/div&gt;</code></pre>
                
                <h3>JavaScript API</h3>
                <pre><code>// Get editor content
const content = document.getElementById('rtfEditor').innerHTML;

// Set editor content
document.getElementById('rtfEditor').innerHTML = content;

// Execute commands
document.execCommand('bold', false, null);
document.execCommand('insertUnorderedList', false, null);</code></pre>
            </div>
        </div>
    </div>

    <script src="https://code.jquery.com/jquery-3.7.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        $(document).ready(function() {
            const editor = document.getElementById('rtfEditor');
            const charCount = document.getElementById('charCount');
            
            // Update character count
            function updateCharCount() {
                const text = editor.innerText || editor.textContent || '';
                charCount.textContent = text.length;
            }
            
            // Toolbar button functionality
            $('.batcat-rtf-btn[data-command]').on('click', function() {
                const command = $(this).data('command');
                document.execCommand(command, false, null);
                editor.focus();
                updateCharCount();
            });
            
            // Heading select
            $('#headingSelect').on('change', function() {
                const value = $(this).val();
                if (value) {
                    document.execCommand('formatBlock', false, value);
                } else {
                    document.execCommand('formatBlock', false, 'div');
                }
                editor.focus();
            });
            
            // Table insertion
            $('#insertTable').on('click', function() {
                $('#tableModal').show();
            });
            
            $('#closeTableModal, #cancelTableBtn').on('click', function() {
                $('#tableModal').hide();
            });
            
            $('#insertTableBtn').on('click', function() {
                const rows = parseInt($('#tableRows').val());
                const cols = parseInt($('#tableCols').val());
                
                let tableHtml = '<table><tbody>';
                for (let i = 0; i < rows; i++) {
                    tableHtml += '<tr>';
                    for (let j = 0; j < cols; j++) {
                        tableHtml += '<td>&nbsp;</td>';
                    }
                    tableHtml += '</tr>';
                }
                tableHtml += '</tbody></table>';
                
                document.execCommand('insertHTML', false, tableHtml);
                $('#tableModal').hide();
                editor.focus();
                updateCharCount();
            });
            
            // Link insertion
            $('#insertLink').on('click', function() {
                $('#linkModal').show();
            });
            
            $('#closeLinkModal, #cancelLinkBtn').on('click', function() {
                $('#linkModal').hide();
            });
            
            $('#insertLinkBtn').on('click', function() {
                const text = $('#linkText').val() || $('#linkText').attr('placeholder');
                const url = $('#linkUrl').val();
                
                if (url) {
                    const linkHtml = `<a href="${url}">${text}</a>`;
                    document.execCommand('insertHTML', false, linkHtml);
                }
                
                $('#linkModal').hide();
                editor.focus();
                updateCharCount();
            });
            
            // Template functionality
            $('.batcat-rtf-template-btn').on('click', function() {
                const template = $(this).data('template');
                let templateContent = '';
                
                switch(template) {
                    case 'progress':
                        templateContent = `
                            <h2>Progress Note</h2>
                            <p><strong>Date:</strong> ${new Date().toLocaleDateString()}</p>
                            <h3>Subjective</h3>
                            <p>Patient reports...</p>
                            <h3>Objective</h3>
                            <p>Vital signs stable. Physical exam reveals...</p>
                            <h3>Assessment</h3>
                            <p>1. Primary diagnosis</p>
                            <p>2. Secondary diagnosis</p>
                            <h3>Plan</h3>
                            <p>1. Continue current medications</p>
                            <p>2. Follow up in 1 week</p>
                        `;
                        break;
                    case 'discharge':
                        templateContent = `
                            <h2>Discharge Summary</h2>
                            <p><strong>Patient:</strong> [Name]</p>
                            <p><strong>Admission Date:</strong> [Date]</p>
                            <p><strong>Discharge Date:</strong> [Date]</p>
                            <h3>Admission Diagnosis</h3>
                            <p>Primary: [Diagnosis]</p>
                            <h3>Hospital Course</h3>
                            <p>Patient was admitted for...</p>
                            <h3>Discharge Instructions</h3>
                            <p>1. Medications</p>
                            <p>2. Follow-up appointments</p>
                            <p>3. Activity restrictions</p>
                        `;
                        break;
                    case 'consultation':
                        templateContent = `
                            <h2>Consultation Note</h2>
                            <p><strong>Referring Physician:</strong> [Name]</p>
                            <p><strong>Reason for Consult:</strong> [Reason]</p>
                            <h3>History</h3>
                            <p>Patient is a [age]-year-old [gender] with...</p>
                            <h3>Assessment</h3>
                            <p>Based on the history and examination...</p>
                            <h3>Recommendations</h3>
                            <p>1. [Recommendation 1]</p>
                            <p>2. [Recommendation 2]</p>
                        `;
                        break;
                }
                
                editor.innerHTML = templateContent;
                updateCharCount();
            });
            
            // Clear button
            $('.batcat-rtf-actions .btn-outline-secondary').on('click', function() {
                if (confirm('Are you sure you want to clear all content?')) {
                    editor.innerHTML = '';
                    updateCharCount();
                }
            });
            
            // Save button
            $('.batcat-rtf-actions .btn-primary').on('click', function() {
                const content = editor.innerHTML;
                console.log('Saving content:', content);
                // Implement save functionality here
                alert('Content saved!');
            });
            
            // Update character count on input
            editor.addEventListener('input', updateCharCount);
            editor.addEventListener('paste', function() {
                setTimeout(updateCharCount, 100);
            });
            
            // Initial character count
            updateCharCount();
            
            // Close modals when clicking outside
            $('.batcat-rtf-modal').on('click', function(e) {
                if (e.target === this) {
                    $(this).hide();
                }
            });
            
            console.log('Clinical Rich Text Editor loaded');
        });
    </script>
</body>
</html>
